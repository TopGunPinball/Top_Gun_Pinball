#config_version=6

##
## Pilot Mission Modes - Pure YAML
## Letters display based on shot COUNT, not specific shots
## Mode tracking with pulsing for available, solid for completed
## Mode rotation on spinner or flight_gear_target switch hits
##

mode:
  start_events: mode_base_started
  stop_events: mode_base_stopped
  priority: 200
  game_mode: true



slide_player:
  # Show initial slide when mode starts - ONLY if not qualified
  mode_pilot_mission_qualifier_started{current_player.topgun_shots_collected==0 and current_player.qualified_mode_number==0}:
    topgun_0:
      action: play
      priority: 200
  
  # Show slide for pre-lit letters - ONLY if not qualified
  mode_pilot_mission_qualifier_started{current_player.topgun_shots_collected==3 and current_player.qualified_mode_number==0}:
    topgun_3:
      action: play
      priority: 200
  
  mode_pilot_mission_qualifier_started{current_player.topgun_shots_collected==2 and current_player.qualified_mode_number==0}:
    topgun_2:
      action: play
      priority: 200
  
  mode_pilot_mission_qualifier_started{current_player.topgun_shots_collected==1 and current_player.qualified_mode_number==0}:
    topgun_1:
      action: play
      priority: 200
  
  # If qualified and have completed all 6 letters, show topgun_6 on ball start
  mode_pilot_mission_qualifier_started{current_player.topgun_shots_collected==0 and current_player.qualified_mode_number>0}:
    topgun_6:
      action: play
      priority: 200
  
  # Update slides as letters light up - remove old slide first
  topgun_letter_t_lit:
    topgun_0:
      action: remove
    topgun_1:
      action: play
      priority: 200
  
  topgun_letter_o_lit:
    topgun_1:
      action: remove
    topgun_2:
      action: play
      priority: 200
  
  topgun_letter_p_lit:
    topgun_2:
      action: remove
    topgun_3:
      action: play
      priority: 200
  
  topgun_letter_g_lit:
    topgun_3:
      action: remove
    topgun_4:
      action: play
      priority: 200
  
  topgun_letter_u_lit:
    topgun_4:
      action: remove
    topgun_5:
      action: play
      priority: 200
  
  topgun_letter_n_lit:
    topgun_5:
      action: remove
    topgun_6:
      action: play
      priority: 200
  
  # Play completion video based on modes_completed_count
  topgun_qualified{current_player.modes_completed_count==0}:
    topgun_letters_complete_1:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==1}:
    topgun_letters_complete_2:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==2}:
    topgun_letters_complete_3:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==3}:
    topgun_letters_complete_4:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==4}:
    topgun_letters_complete_5:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==5}:
    topgun_letters_complete_6:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==6}:
    topgun_letters_complete_7:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==7}:
    topgun_letters_complete_8:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==8}:
    topgun_letters_complete_9:
      action: play
      priority: 300
  
  topgun_qualified{current_player.modes_completed_count==9}:
    topgun_letters_complete_10:
      action: play
      priority: 300
  
  # Reset to no letters - only show topgun_0 if NOT qualified (still collecting)
  topgun_letters_reset{current_player.qualified_mode_number==0}:
    topgun_6:
      action: remove
    topgun_0:
      action: play
      priority: 200
  
  # If qualified, just remove topgun_6 without showing anything
  topgun_letters_reset{current_player.qualified_mode_number>0}:
    topgun_6:
      action: remove
  
  # Remove all slides when mode stops
  mode_pilot_mission_qualifier_stopped:
    topgun_0:
      action: remove
    topgun_1:
      action: remove
    topgun_2:
      action: remove
    topgun_3:
      action: remove
    topgun_4:
      action: remove
    topgun_5:
      action: remove
    topgun_6:
      action: remove

##############################################
## Player Variables - Track Progress
##############################################

variable_player:
  player_added:
    # GLOBAL pause flag - set by ANY mode that should block letter collection
    letter_collection_paused:
      action: set
      int: 0
    # Shot counter (resets after each TOPGUN complete)
    topgun_shots_collected:
      action: set
      int: 0
    # Total modes completed (0-10)
    modes_completed_count:
      action: set
      int: 0
    # Which mode is currently qualified (0 = none, 1-10 = mode number)
    qualified_mode_number:
      action: set
      int: 0
    # Pause shot collection during skillshot/multiball (0=active, 1=paused)
    pilot_qualifier_paused:
      action: set
      int: 0
    # Track which modes are PLAYED (win or loss - prevents re-qualification)
    mode_rescue_cougar_played:
      action: set
      int: 0
    mode_balls_of_fire_played:
      action: set
      int: 0
    mode_cool_under_pressure_played:
      action: set
      int: 0
    mode_battle_jester_played:
      action: set
      int: 0
    mode_no_points_for_second_place_played:
      action: set
      int: 0
    mode_edge_of_space_played:
      action: set
      int: 0
    mode_below_the_hard_deck_played:
      action: set
      int: 0
    mode_canyon_run_played:
      action: set
      int: 0
    mode_rise_of_phoenix_played:
      action: set
      int: 0
    mode_no_margin_for_error_played:
      action: set
      int: 0
    # Track which modes are WON (for bonus scoring)
    mode_rescue_cougar_won:
      action: set
      int: 0
    mode_balls_of_fire_won:
      action: set
      int: 0
    mode_cool_under_pressure_won:
      action: set
      int: 0
    mode_battle_jester_won:
      action: set
      int: 0
    mode_no_points_for_second_place_won:
      action: set
      int: 0
    mode_edge_of_space_won:
      action: set
      int: 0
    mode_below_the_hard_deck_won:
      action: set
      int: 0
    mode_canyon_run_won:
      action: set
      int: 0
    mode_rise_of_phoenix_won:
      action: set
      int: 0
    mode_no_margin_for_error_won:
      action: set
      int: 0
  
  # Clear pause flag when rescue_cougar stops (can't do this in rescue_cougar itself)
  mode_rescue_cougar_stopped:
    letter_collection_paused:
      action: set
      int: 0
    # Letter display tracking (based on count, not specific shots)
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

##############################################
## Shot Hit Tracking - ANY Shot Increments Counter
##############################################

  # ANY active shot just increments the counter
  # Only count shots when NOT paused (either flag) AND not qualified
  
  s_lane_left_active{current_player.pilot_qualifier_paused==0 and current_player.letter_collection_paused==0 and current_player.qualified_mode_number==0}:
    topgun_shots_collected:
      action: add
      int: 1

  s_orbit_left_active{current_player.pilot_qualifier_paused==0 and current_player.letter_collection_paused==0 and current_player.qualified_mode_number==0}:
    topgun_shots_collected:
      action: add
      int: 1

  s_ramp_left_exit_active{current_player.pilot_qualifier_paused==0 and current_player.letter_collection_paused==0 and current_player.qualified_mode_number==0}:
    topgun_shots_collected:
      action: add
      int: 1

  s_spinner_active{current_player.pilot_qualifier_paused==0 and current_player.letter_collection_paused==0 and current_player.qualified_mode_number==0}:
    topgun_shots_collected:
      action: add
      int: 1

  s_ramp_tower_exit_active{current_player.pilot_qualifier_paused==0 and current_player.letter_collection_paused==0 and current_player.qualified_mode_number==0}:
    topgun_shots_collected:
      action: add
      int: 1

  s_orbit_upper_active{current_player.pilot_qualifier_paused==0 and current_player.letter_collection_paused==0 and current_player.qualified_mode_number==0}:
    topgun_shots_collected:
      action: add
      int: 1

  s_ramp_inner_exit_active{current_player.pilot_qualifier_paused==0 and current_player.letter_collection_paused==0 and current_player.qualified_mode_number==0}:
    topgun_shots_collected:
      action: add
      int: 1

  s_ramp_right_exit_active{current_player.pilot_qualifier_paused==0 and current_player.letter_collection_paused==0 and current_player.qualified_mode_number==0}:
    topgun_shots_collected:
      action: add
      int: 1

  ##############################################
  ## Pause/Unpause During Other Modes
  ##############################################
  
  # Pause during skillshot
  mode_skillshot_started:
    pilot_qualifier_paused:
      action: set
      int: 1
  
  # Unpause when skillshot ends
  mode_skillshot_stopped:
    pilot_qualifier_paused:
      action: set
      int: 0
  
  ##############################################
  ## Set Flag When Mode Is Qualified
  ##############################################
  
  qualify_rescue_cougar:
    qualified_mode_number:
      action: set
      int: 1
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_balls_of_fire:
    qualified_mode_number:
      action: set
      int: 2
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_cool_under_pressure:
    qualified_mode_number:
      action: set
      int: 3
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_battle_jester:
    qualified_mode_number:
      action: set
      int: 4
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_no_points_for_second_place:
    qualified_mode_number:
      action: set
      int: 5
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_edge_of_space:
    qualified_mode_number:
      action: set
      int: 6
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_below_the_hard_deck:
    qualified_mode_number:
      action: set
      int: 7
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_canyon_run:
    qualified_mode_number:
      action: set
      int: 8
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_rise_of_phoenix:
    qualified_mode_number:
      action: set
      int: 9
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  qualify_no_margin_for_error:
    qualified_mode_number:
      action: set
      int: 10
    topgun_shots_collected:
      action: set
      int: 0
    topgun_letter_t:
      action: set
      int: 0
    topgun_letter_o:
      action: set
      int: 0
    topgun_letter_p:
      action: set
      int: 0
    topgun_letter_g:
      action: set
      int: 0
    topgun_letter_u:
      action: set
      int: 0
    topgun_letter_n:
      action: set
      int: 0

  ##############################################
  ## Mark Modes Complete When They Start
  ##############################################
  
  # Mark mode as PLAYED (either won or lost) and WON when completed
  rescue_cougar_complete:
    mode_rescue_cougar_played:
      action: set
      int: 1
    mode_rescue_cougar_won:
      action: set
      int: 1
    modes_completed_count:
      action: add
      int: 1
  
  # Mark mode as PLAYED (but not won) when failed
  rescue_cougar_failed:
    mode_rescue_cougar_played:
      action: set
      int: 1
  
  # Clear qualified number when mode starts (so player can't start it again mid-game)
  mode_rescue_cougar_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use balls_of_fire_complete event when mode exists)
  # balls_of_fire_complete:
  #   mode_balls_of_fire_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_balls_of_fire_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use cool_under_pressure_complete event when mode exists)
  # cool_under_pressure_complete:
  #   mode_cool_under_pressure_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_cool_under_pressure_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use battle_jester_complete event when mode exists)
  # battle_jester_complete:
  #   mode_battle_jester_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_battle_jester_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use no_points_for_second_place_complete event when mode exists)
  # no_points_for_second_place_complete:
  #   mode_no_points_for_second_place_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_no_points_for_second_place_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use edge_of_space_complete event when mode exists)
  # edge_of_space_complete:
  #   mode_edge_of_space_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_edge_of_space_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use below_the_hard_deck_complete event when mode exists)
  # below_the_hard_deck_complete:
  #   mode_below_the_hard_deck_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_below_the_hard_deck_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use canyon_run_complete event when mode exists)
  # canyon_run_complete:
  #   mode_canyon_run_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_canyon_run_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use rise_of_phoenix_complete event when mode exists)
  # rise_of_phoenix_complete:
  #   mode_rise_of_phoenix_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_rise_of_phoenix_started:
    qualified_mode_number:
      action: set
      int: 0

  # Mark mode as complete when the mode is WON (use no_margin_for_error_complete event when mode exists)
  # no_margin_for_error_complete:
  #   mode_no_margin_for_error_complete:
  #     action: set
  #     int: 1
  #   modes_completed_count:
  #     action: add
  #     int: 1
  
  # Clear qualified number when mode starts
  mode_no_margin_for_error_started:
    qualified_mode_number:
      action: set
      int: 0
  
  topgun_qualified:
    score:
      action: add
      int: 100000 * current_player.total_scoring_multiplier
      block: true


##############################################
## Coil Player - Mode Barrier Control
##############################################

coil_player:
  # Drop and hold barrier when any mode is qualified
  topgun_qualified:
    c_mode_barrier:
      action: pulse
      hold_power: 0.125

  # Release barrier when any pilot mission mode starts
  mode_rescue_cougar_started:
    c_mode_barrier:
      action: disable

  mode_balls_of_fire_started:
    c_mode_barrier:
      action: disable

  mode_cool_under_pressure_started:
    c_mode_barrier:
      action: disable

  mode_battle_jester_started:
    c_mode_barrier:
      action: disable

  mode_no_points_for_second_place_started:
    c_mode_barrier:
      action: disable

  mode_edge_of_space_started:
    c_mode_barrier:
      action: disable

  mode_below_the_hard_deck_started:
    c_mode_barrier:
      action: disable

  mode_canyon_run_started:
    c_mode_barrier:
      action: disable

  mode_rise_of_phoenix_started:
    c_mode_barrier:
      action: disable

  mode_no_margin_for_error_started:
    c_mode_barrier:
      action: disable

  # Restore barrier on ball start if a mode is qualified
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number>0}:
    c_mode_barrier:
      action: pulse
      hold_power: 0.125

##############################################
## Event Player - Mode Qualification & Rotation
##############################################

event_player:
  # Determine which mode qualifies based on completed count
  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==0}:
    - qualify_rescue_cougar
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==0}:
    - qualify_balls_of_fire
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==0}:
    - qualify_cool_under_pressure
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==0}:
    - qualify_battle_jester
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==0}:
    - qualify_no_points_for_second_place
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==0}:
    - qualify_edge_of_space
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==0}:
    - qualify_below_the_hard_deck
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==0}:
    - qualify_canyon_run
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==0}:
    - qualify_rise_of_phoenix
    - topgun_qualified

  player_topgun_shots_collected{value==6 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_complete==0}:
    - qualify_no_margin_for_error
    - topgun_qualified
  
  # Restore qualified mode light on ball start (each ball)
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==1}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==2}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==3}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==4}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==5}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==6}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==7}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==8}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==9}:
    - restore_qualified_mode_light
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==10}:
    - restore_qualified_mode_light
  
  ##############################################
  ## Mode Rotation - Spinner and Flight Gear Hits
  ##############################################
  
  # Rotate qualified mode on spinner or flight_gear_target hit (only when qualified)
  s_spinner_active{current_player.qualified_mode_number>0}:
    - stop_all_mode_pulse_shows
    - rotate_qualified_mode
  
  s_flight_gear_target_active{current_player.qualified_mode_number>0}:
    - stop_all_mode_pulse_shows
    - rotate_qualified_mode_backwards
  
  ##############################################
  ## Letter Lighting Based on Shot Count
  ##############################################
  
  player_topgun_shots_collected{value==1}:
    topgun_letter_t_lit
  
  player_topgun_shots_collected{value==2}:
    topgun_letter_o_lit
  
  player_topgun_shots_collected{value==3}:
    topgun_letter_p_lit
  
  player_topgun_shots_collected{value==4}:
    topgun_letter_g_lit
  
  player_topgun_shots_collected{value==5}:
    topgun_letter_u_lit
  
  player_topgun_shots_collected{value==6}:
    topgun_letter_n_lit
  
  ##############################################
  ## Mode Rotation Forward Logic
  ##############################################
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode{current_player.qualified_mode_number==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode{current_player.qualified_mode_number==2 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode{current_player.qualified_mode_number==2 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode{current_player.qualified_mode_number==2 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode{current_player.qualified_mode_number==2 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode{current_player.qualified_mode_number==2 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode{current_player.qualified_mode_number==2 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode{current_player.qualified_mode_number==2 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode{current_player.qualified_mode_number==2 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode{current_player.qualified_mode_number==3 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode{current_player.qualified_mode_number==3 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode{current_player.qualified_mode_number==3 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode{current_player.qualified_mode_number==3 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode{current_player.qualified_mode_number==3 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode{current_player.qualified_mode_number==3 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode{current_player.qualified_mode_number==3 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode{current_player.qualified_mode_number==4 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode{current_player.qualified_mode_number==4 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode{current_player.qualified_mode_number==4 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode{current_player.qualified_mode_number==4 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode{current_player.qualified_mode_number==4 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode{current_player.qualified_mode_number==4 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode{current_player.qualified_mode_number==5 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode{current_player.qualified_mode_number==5 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode{current_player.qualified_mode_number==5 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode{current_player.qualified_mode_number==5 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode{current_player.qualified_mode_number==5 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode{current_player.qualified_mode_number==6 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode{current_player.qualified_mode_number==6 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode{current_player.qualified_mode_number==6 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode{current_player.qualified_mode_number==6 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode{current_player.qualified_mode_number==7 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode{current_player.qualified_mode_number==7 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode{current_player.qualified_mode_number==7 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode{current_player.qualified_mode_number==8 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode{current_player.qualified_mode_number==8 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode{current_player.qualified_mode_number==9 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  
  # Mode 10 wraps back to mode 1 (rescue_cougar) when rotating forward
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode{current_player.qualified_mode_number==10 and current_player.mode_rescue_cougar_played==1 and current_player.mode_balls_of_fire_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix

  ##############################################
  ## Mode Rotation Backward Logic
  ##############################################
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==10 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==1 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==9 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==9 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==9 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==9 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==9 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==9 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==9 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==9 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==1 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==8 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==8 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==8 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==8 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==8 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==8 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==8 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==1 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==7 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==7 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==7 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==7 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==7 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==7 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==1 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==6 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==6 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==6 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==6 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==6 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==1 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==5 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==5 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==5 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==5 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==1 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==4 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==4 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==4 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==1 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==3 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==3 and current_player.mode_balls_of_fire_played==1 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==0}:
    qualify_rescue_cougar
  
  # If at mode 2 and mode 1 is played, wrap to mode 10
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==1 and current_player.mode_no_margin_for_error_played==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==1 and current_player.mode_no_margin_for_error_played==1 and current_player.mode_rise_of_phoenix_played==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==1 and current_player.mode_no_margin_for_error_played==1 and current_player.mode_rise_of_phoenix_played==1 and current_player.mode_canyon_run_played==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==1 and current_player.mode_no_margin_for_error_played==1 and current_player.mode_rise_of_phoenix_played==1 and current_player.mode_canyon_run_played==1 and current_player.mode_below_the_hard_deck_played==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==1 and current_player.mode_no_margin_for_error_played==1 and current_player.mode_rise_of_phoenix_played==1 and current_player.mode_canyon_run_played==1 and current_player.mode_below_the_hard_deck_played==1 and current_player.mode_edge_of_space_played==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==1 and current_player.mode_no_margin_for_error_played==1 and current_player.mode_rise_of_phoenix_played==1 and current_player.mode_canyon_run_played==1 and current_player.mode_below_the_hard_deck_played==1 and current_player.mode_edge_of_space_played==1 and current_player.mode_no_points_for_second_place_played==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==2 and current_player.mode_rescue_cougar_played==1 and current_player.mode_no_margin_for_error_played==1 and current_player.mode_rise_of_phoenix_played==1 and current_player.mode_canyon_run_played==1 and current_player.mode_below_the_hard_deck_played==1 and current_player.mode_edge_of_space_played==1 and current_player.mode_no_points_for_second_place_played==1 and current_player.mode_battle_jester_played==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  
  # Mode 1 wraps back to mode 10 (no_margin_for_error) when rotating backward
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_played==0}:
    qualify_no_margin_for_error
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_complete==1 and current_player.mode_rise_of_phoenix_played==0}:
    qualify_rise_of_phoenix
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_played==0}:
    qualify_canyon_run
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_played==0}:
    qualify_below_the_hard_deck
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_played==0}:
    qualify_edge_of_space
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_played==0}:
    qualify_no_points_for_second_place
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_played==0}:
    qualify_battle_jester
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_played==0}:
    qualify_cool_under_pressure
  
  rotate_qualified_mode_backwards{current_player.qualified_mode_number==1 and current_player.mode_no_margin_for_error_complete==1 and current_player.mode_rise_of_phoenix_complete==1 and current_player.mode_canyon_run_complete==1 and current_player.mode_below_the_hard_deck_complete==1 and current_player.mode_edge_of_space_complete==1 and current_player.mode_no_points_for_second_place_complete==1 and current_player.mode_battle_jester_complete==1 and current_player.mode_cool_under_pressure_complete==1 and current_player.mode_balls_of_fire_played==0}:
    qualify_balls_of_fire

  ##############################################
  ## Mode Selection - Start Mode on Scoop Hit
  ##############################################
  
  # Mode selection based on qualified mode when scoop is hit
  s_mode_start_active{current_player.qualified_mode_number==1 and current_player.mode_rescue_cougar_played==0}:
    - start_mode_rescue_cougar
  
  s_mode_start_active{current_player.qualified_mode_number==2 and current_player.mode_balls_of_fire_complete==0}:
    - start_mode_balls_of_fire
  
  s_mode_start_active{current_player.qualified_mode_number==3 and current_player.mode_cool_under_pressure_complete==0}:
    - start_mode_cool_under_pressure
  
  s_mode_start_active{current_player.qualified_mode_number==4 and current_player.mode_battle_jester_complete==0}:
    - start_mode_battle_jester
  
  s_mode_start_active{current_player.qualified_mode_number==5 and current_player.mode_no_points_for_second_place_complete==0}:
    - start_mode_no_points_for_second_place
  
  s_mode_start_active{current_player.qualified_mode_number==6 and current_player.mode_edge_of_space_complete==0}:
    - start_mode_edge_of_space
  
  s_mode_start_active{current_player.qualified_mode_number==7 and current_player.mode_below_the_hard_deck_complete==0}:
    - start_mode_below_the_hard_deck
  
  s_mode_start_active{current_player.qualified_mode_number==8 and current_player.mode_canyon_run_complete==0}:
    - start_mode_canyon_run
  
  s_mode_start_active{current_player.qualified_mode_number==9 and current_player.mode_rise_of_phoenix_complete==0}:
    - start_mode_rise_of_phoenix
  
  s_mode_start_active{current_player.qualified_mode_number==10 and current_player.mode_no_margin_for_error_complete==0}:
    - start_mode_no_margin_for_error
  
  ##############################################
  ## TOPGUN Reset Handler
  ##############################################
  
  # TOPGUN Letter Reset - triggered by any pilot mission mode starting
  reset_topgun_letters:
    - topgun_letters_reset
  
  # TOPGUN reset when any pilot mission mode starts
  mode_rescue_cougar_started:
    - reset_topgun_letters
  
  mode_balls_of_fire_started:
    - reset_topgun_letters
  
  mode_cool_under_pressure_started:
    - reset_topgun_letters
  
  mode_battle_jester_started:
    - reset_topgun_letters
  
  mode_no_points_for_second_place_started:
    - reset_topgun_letters
  
  mode_edge_of_space_started:
    - reset_topgun_letters
  
  mode_below_the_hard_deck_started:
    - reset_topgun_letters
  
  mode_canyon_run_started:
    - reset_topgun_letters
  
  mode_rise_of_phoenix_started:
    - reset_topgun_letters
  
  mode_no_margin_for_error_started:
    - reset_topgun_letters

  # Reset letters when new ball starts
  ball_will_end:
    topgun_letters_reset

##############################################
## Show Player
##############################################

show_player:
  # Pulse all shot lights when mode starts and not qualified
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==0}:
    qualifying_shots_pulse:
      loops: -1
      speed: 1
  
  # Stop pulsing when qualified
  topgun_qualified:
    qualifying_shots_pulse:
      action: stop
  
  # Stop pulsing when letter collection paused
  player_letter_collection_paused{value==1 and current_player.qualified_mode_number==0}:
    qualifying_shots_pulse:
      action: stop
  
  # Restart pulsing when letter collection unpaused (and not yet qualified)
  player_letter_collection_paused{value==0 and current_player.qualified_mode_number==0}:
    qualifying_shots_pulse:
      loops: -1
      speed: 1
  
  # Stop all pulse shows so new one can start
  stop_all_mode_pulse_shows:
    rescue_cougar_pulse:
      action: stop
    balls_of_fire_pulse:
      action: stop
    cool_under_pressure_pulse:
      action: stop
    battle_jester_pulse:
      action: stop
    no_points_pulse:
      action: stop
    edge_of_space_pulse:
      action: stop
    below_hard_deck_pulse:
      action: stop
    canyon_run_pulse:
      action: stop
    rise_of_phoenix_pulse:
      action: stop
    no_margin_pulse:
      action: stop
  
  # Pulse appropriate mode light when qualified (will stop when mode starts)
  qualify_rescue_cougar:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_rescue_cougar
        color: white
      key: rescue_cougar_pulse
  
  qualify_balls_of_fire:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_balls_of_fire
        color: white
      key: balls_of_fire_pulse
  
  qualify_cool_under_pressure:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_cool_under_pressure
        color: white
      key: cool_under_pressure_pulse
  
  qualify_battle_jester:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_battle_jester
        color: white
      key: battle_jester_pulse
  
  qualify_no_points_for_second_place:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_no_points_for_second_place
        color: white
      key: no_points_pulse
  
  qualify_edge_of_space:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_edge_of_space
        color: white
      key: edge_of_space_pulse
  
  qualify_below_the_hard_deck:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_below_the_hard_deck
        color: white
      key: below_hard_deck_pulse
  
  qualify_canyon_run:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_canyon_run
        color: white
      key: canyon_run_pulse
  
  qualify_rise_of_phoenix:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_rise_of_phoenix
        color: white
      key: rise_of_phoenix_pulse
  
  qualify_no_margin_for_error:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_no_margin_for_error
        color: white
      key: no_margin_pulse
  
  # Stop pulsing when modes start (will be solid white from light_player)
  mode_rescue_cougar_started:
    rescue_cougar_pulse:
      action: stop
  
  mode_balls_of_fire_started:
    balls_of_fire_pulse:
      action: stop
  
  mode_cool_under_pressure_started:
    cool_under_pressure_pulse:
      action: stop
  
  mode_battle_jester_started:
    battle_jester_pulse:
      action: stop
  
  mode_no_points_for_second_place_started:
    no_points_pulse:
      action: stop
  
  mode_edge_of_space_started:
    edge_of_space_pulse:
      action: stop
  
  mode_below_the_hard_deck_started:
    below_hard_deck_pulse:
      action: stop
  
  mode_canyon_run_started:
    canyon_run_pulse:
      action: stop
  
  mode_rise_of_phoenix_started:
    rise_of_phoenix_pulse:
      action: stop
  
  mode_no_margin_for_error_started:
    no_margin_pulse:
      action: stop
  
  # Restore pulsing on ball start if still qualified
  restore_qualified_mode_light{current_player.qualified_mode_number==1 and current_player.mode_rescue_cougar_played==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_rescue_cougar
        color: white
      key: rescue_cougar_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==2 and current_player.mode_balls_of_fire_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_balls_of_fire
        color: white
      key: balls_of_fire_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==3 and current_player.mode_cool_under_pressure_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_cool_under_pressure
        color: white
      key: cool_under_pressure_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==4 and current_player.mode_battle_jester_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_battle_jester
        color: white
      key: battle_jester_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==5 and current_player.mode_no_points_for_second_place_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_no_points_for_second_place
        color: white
      key: no_points_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==6 and current_player.mode_edge_of_space_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_edge_of_space
        color: white
      key: edge_of_space_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==7 and current_player.mode_below_the_hard_deck_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_below_the_hard_deck
        color: white
      key: below_hard_deck_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==8 and current_player.mode_canyon_run_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_canyon_run
        color: white
      key: canyon_run_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==9 and current_player.mode_rise_of_phoenix_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_rise_of_phoenix
        color: white
      key: rise_of_phoenix_pulse
  
  restore_qualified_mode_light{current_player.qualified_mode_number==10 and current_player.mode_no_margin_for_error_complete==0}:
    pulse_mode_light:
      loops: -1
      speed: 1
      show_tokens:
        led: l_mode_no_margin_for_error
        color: white
      key: no_margin_pulse

shows:
  qualifying_shots_pulse:
    - duration: 0.75s
      lights:
        l_shot_left_lane: white
        l_shot_left_orbit: white
        l_shot_left_ramp: white
        l_shot_spinner: white
        l_shot_tower_ramp: white
        l_shot_upper_orbit: white
        l_shot_middle_ramp: white
        l_shot_right_orbit: white
    - duration: 0.75s
      lights:
        l_shot_left_lane: off
        l_shot_left_orbit: off
        l_shot_left_ramp: off
        l_shot_spinner: off
        l_shot_tower_ramp: off
        l_shot_upper_orbit: off
        l_shot_middle_ramp: off
        l_shot_right_orbit: off

##############################################
## Light Player
##############################################

light_player:
  # Turn on pilot mission lit indicator AND turn off all shot lights when qualified
  topgun_qualified:
    l_pilot_mission_lit:
      color: white
      fade: 100ms
    l_shot_left_lane:
      color: off
    l_shot_left_orbit:
      color: off
    l_shot_left_ramp:
      color: off
    l_shot_spinner:
      color: off
    l_shot_tower_ramp:
      color: off
    l_shot_upper_orbit:
      color: off
    l_shot_middle_ramp:
      color: off
    l_shot_right_orbit:
      color: off
  
  # Turn off pilot mission lit when mode starts ONLY if not qualified
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number==0}:
    l_pilot_mission_lit:
      color: off
  
  # Keep pilot mission lit ON when mode starts if qualified
  mode_pilot_mission_qualifier_started{current_player.qualified_mode_number>0}:
    l_pilot_mission_lit:
      color: white
      fade: 0ms

  # Restore base mode light on ball start if qualified (pulsing handled by show_player)
  restore_qualified_mode_light{current_player.qualified_mode_number==1}:
    l_mode_rescue_cougar:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==2}:
    l_mode_balls_of_fire:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==3}:
    l_mode_cool_under_pressure:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==4}:
    l_mode_battle_jester:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==5}:
    l_mode_no_points_for_second_place:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==6}:
    l_mode_edge_of_space:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==7}:
    l_mode_below_the_hard_deck:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==8}:
    l_mode_canyon_run:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==9}:
    l_mode_rise_of_phoenix:
      color: white
  restore_qualified_mode_light{current_player.qualified_mode_number==10}:
    l_mode_no_margin_for_error:
      color: white

  # Turn off all mode lights AFTER shows are stopped
  stop_all_mode_pulse_shows:
    l_mode_rescue_cougar:
      color: off
    l_mode_balls_of_fire:
      color: off
    l_mode_cool_under_pressure:
      color: off
    l_mode_battle_jester:
      color: off
    l_mode_no_points_for_second_place:
      color: off
    l_mode_edge_of_space:
      color: off
    l_mode_below_the_hard_deck:
      color: off
    l_mode_canyon_run:
      color: off
    l_mode_rise_of_phoenix:
      color: off
    l_mode_no_margin_for_error:
      color: off

  # Restore completed mode lights to SOLID WHITE after rotation
  stop_all_mode_pulse_shows{current_player.mode_rescue_cougar_played==1}:
    l_mode_rescue_cougar:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_balls_of_fire_complete==1}:
    l_mode_balls_of_fire:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_cool_under_pressure_complete==1}:
    l_mode_cool_under_pressure:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_battle_jester_complete==1}:
    l_mode_battle_jester:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_no_points_for_second_place_complete==1}:
    l_mode_no_points_for_second_place:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_edge_of_space_complete==1}:
    l_mode_edge_of_space:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_below_the_hard_deck_complete==1}:
    l_mode_below_the_hard_deck:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_canyon_run_complete==1}:
    l_mode_canyon_run:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_rise_of_phoenix_complete==1}:
    l_mode_rise_of_phoenix:
      color: white
      fade: 0ms
  
  stop_all_mode_pulse_shows{current_player.mode_no_margin_for_error_complete==1}:
    l_mode_no_margin_for_error:
      color: white
      fade: 0ms

  # Initial light when qualified (will be overridden by pulsing show)
  qualify_rescue_cougar:
    l_mode_rescue_cougar:
      color: white
  qualify_balls_of_fire:
    l_mode_balls_of_fire:
      color: white
  qualify_cool_under_pressure:
    l_mode_cool_under_pressure:
      color: white
  qualify_battle_jester:
    l_mode_battle_jester:
      color: white
  qualify_no_points_for_second_place:
    l_mode_no_points_for_second_place:
      color: white
  qualify_edge_of_space:
    l_mode_edge_of_space:
      color: white
  qualify_below_the_hard_deck:
    l_mode_below_the_hard_deck:
      color: white
  qualify_canyon_run:
    l_mode_canyon_run:
      color: white
  qualify_rise_of_phoenix:
    l_mode_rise_of_phoenix:
      color: white
  qualify_no_margin_for_error:
    l_mode_no_margin_for_error:
      color: white

  # Turn off pilot mission lit AND set mode lights to SOLID white when modes start
  mode_rescue_cougar_started:
    l_pilot_mission_lit:
      color: off
    l_mode_rescue_cougar:
      color: white
      fade: 0ms
      
  mode_balls_of_fire_started:
    l_pilot_mission_lit:
      color: off
    l_mode_balls_of_fire:
      color: white
      fade: 0ms
      
  mode_cool_under_pressure_started:
    l_pilot_mission_lit:
      color: off
    l_mode_cool_under_pressure:
      color: white
      fade: 0ms
      
  mode_battle_jester_started:
    l_pilot_mission_lit:
      color: off
    l_mode_battle_jester:
      color: white
      fade: 0ms
      
  mode_no_points_for_second_place_started:
    l_pilot_mission_lit:
      color: off
    l_mode_no_points_for_second_place:
      color: white
      fade: 0ms
      
  mode_edge_of_space_started:
    l_pilot_mission_lit:
      color: off
    l_mode_edge_of_space:
      color: white
      fade: 0ms
      
  mode_below_the_hard_deck_started:
    l_pilot_mission_lit:
      color: off
    l_mode_below_the_hard_deck:
      color: white
      fade: 0ms
      
  mode_canyon_run_started:
    l_pilot_mission_lit:
      color: off
    l_mode_canyon_run:
      color: white
      fade: 0ms
      
  mode_rise_of_phoenix_started:
    l_pilot_mission_lit:
      color: off
    l_mode_rise_of_phoenix:
      color: white
      fade: 0ms
      
  mode_no_margin_for_error_started:
    l_pilot_mission_lit:
      color: off
    l_mode_no_margin_for_error:
      color: white
      fade: 0ms

##############################################
## Sound Player (Optional - Uncomment when sounds are ready)
##############################################

# sound_player:
#   s_lane_left_active:
#     sfx_letter:
#       action: play
#   s_orbit_left_active:
#     sfx_letter:
#       action: play
#   s_ramp_left_exit_active:
#     sfx_letter:
#       action: play
#   s_spinner_active:
#     sfx_letter:
#       action: play
#   s_ramp_tower_exit_active:
#     sfx_letter:
#       action: play
#   s_orbit_upper_active:
#     sfx_letter:
#       action: play
#   s_ramp_inner_exit_active:
#     sfx_letter:
#       action: play
#   s_ramp_right_exit_active:
#     sfx_letter:
#       action: play
#   
#   topgun_qualified:
#     sfx_topgun_complete:
#       action: play
#   
#   rotate_qualified_mode:
#     sfx_mode_rotate:
#       action: play

# sounds:
#   sfx_letter:
#     file: letter_collect.wav
#     streaming: false
#   sfx_topgun_complete:
#     file: topgun_qualified.wav
#     streaming: false
#   sfx_mode_rotate:
#     file: mode_change.wav
#     streaming: false