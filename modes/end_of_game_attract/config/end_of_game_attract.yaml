#config_version=6

##############################################################################
# END OF GAME ATTRACT MODE
# 
# Plays after bonus completes when the game ends.
# Shows a single slide for 2 minutes 11 seconds (131 seconds).
# Both flippers pressed = skip to main attract mode.
# Light shows cycle in sequence until mode ends.
#
# After completion, transitions to main attract mode via
# mode_end_of_game_attract_stopped event.
##############################################################################

mode:
  start_events: game_ended
  stop_events: 
    - game_starting
    - end_of_game_carousel_complete
    - end_of_game_skip
  priority: 20
  game_mode: false

##############################################################################
# TIMER - 2 minutes 11 seconds = 131 seconds
##############################################################################

timers:
  end_of_game_timer:
    start_value: 0
    end_value: 131
    direction: up
    tick_interval: 1s
    control_events:
      - event: mode_end_of_game_attract_started
        action: start

##############################################################################
# EVENT PLAYER
##############################################################################

event_player:
  # Timer complete â†’ end mode
  timer_end_of_game_timer_complete: end_of_game_carousel_complete

  # Both flippers detection
  s_flipper_left_active: end_of_game_check_both_flippers
  s_flipper_right_active: end_of_game_check_both_flippers
  end_of_game_check_both_flippers{device.switches.s_flipper_left.state and device.switches.s_flipper_right.state}:
    - end_of_game_skip

  # Kick off the light show chain
  mode_end_of_game_attract_started: end_of_game_light_step_1

##############################################################################
# SLIDE PLAYER - Single slide for the entire mode
##############################################################################

slide_player:
  mode_end_of_game_attract_started:
    end_of_game_attract:
      priority: 100

##############################################################################
# SOUND PLAYER
##############################################################################

sound_player:
  # Silence music bus so the video audio plays cleanly
  mode_end_of_game_attract_started:
    silence:
      bus: music
      loops: 0

##############################################################################
# SHOW PLAYER - Chained light shows
#
# ADJUSTING LOOP COUNT:
#   Change the 'loops' value for each show to control how many times
#   it plays before moving to the next show.
#   loops: 1 = play once, loops: 2 = play twice, etc.
#
# ADJUSTING SPEED:
#   Change the 'speed' value (higher = faster).
##############################################################################

show_player:
  end_of_game_light_step_1:
    end_of_game_1:
      loops: 1
      speed: 40
      priority: 200
      events_when_completed: end_of_game_light_step_2

  end_of_game_light_step_2:
    end_of_game_2:
      loops: 1
      speed: 40
      priority: 200
      events_when_completed: end_of_game_light_step_3

  end_of_game_light_step_3:
    end_of_game_3:
      loops: 1
      speed: 40
      priority: 200
      events_when_completed: end_of_game_light_step_4

  end_of_game_light_step_4:
    end_of_game_4:
      loops: 1
      speed: 40
      priority: 200
      events_when_completed: end_of_game_light_step_1

  # Clean stop all shows when mode ends
  mode_end_of_game_attract_stopping:
    end_of_game_1: stop
    end_of_game_2: stop
    end_of_game_3: stop
    end_of_game_4: stop