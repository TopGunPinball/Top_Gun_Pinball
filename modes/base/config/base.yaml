#config_version=6

# Base mode that starts at the beginning of each ball
# and stops at the end of each ball.
# Slides at 50(Video Background) and 0 (no video Playing)

mode:
  start_events: ball_starting
  stop_events: ball_will_end
  priority: 100

event_player:
  mode_base_started:
    - start_mode_bumpers
  mode_base_will_stop:
    - stop_mode_bumpers

variable_player:
  ##############################################
  ## Total Scoring Multiplier - FIXED VERSION
  ## Initialize on BOTH player_added AND mode start
  ##############################################

  # Initialize on player added (in case base mode already running)
  player_added:
    total_scoring_multiplier:
      action: set
      float: 1.0

  # ALSO initialize when base mode starts (this is the key fix!)
  mode_base_started:
    total_scoring_multiplier:
      action: set
      float: current_player.mach_level * (1 + current_player.x2_multiplier)

  # Recalculate whenever mach_level changes
  player_mach_level:
    total_scoring_multiplier:
      action: set
      float: current_player.mach_level * (1 + current_player.x2_multiplier)
  
  # Recalculate whenever x2_multiplier changes
  player_x2_multiplier:
    total_scoring_multiplier:
      action: set
      float: current_player.mach_level * (1 + current_player.x2_multiplier)

slide_player:
  mode_base_started: base_slide
  
  # Handle skillshot videos in base mode so they continue after skillshot mode ends
  show_skillshot_mig_video:
    skillshot_mig_hit:
      action: play
      expire: 3.5s  # Auto-remove after 5 seconds
  show_skillshot_miramar_video:
    skillshot_miramar:
      action: play
      expire: 3.5s  # Auto-remove after 5 seconds
  show_skillshot_tower_video:
    skillshot_tower:
      action: play
      expire: 5s  # Auto-remove after 5 seconds
  show_skillshot_inverted_video:
    skillshot_inverted:
      action: play
      expire: 8s  # Auto-remove after 5 seconds

sound_player:
  playfield_active:
    music_danger_zone:
      bus: music
